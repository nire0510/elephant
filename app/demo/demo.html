<!DOCTYPE html>
<html lang="en-US">
<head>
	<title></title>
	<meta charset="utf-8">
	<script src="../bower_components/lodash/dist/lodash.compat.min.js"></script>
	<script src="../src/elephant.js"></script>
</head>
<body>
<script>
	// Create a new store for queries related to weather:
	ElephantJS.create('Weather', {
		'endpoint': 'http://api.openweathermap.org/data/2.5/weather',
		'format': 'json',
		'success': [function (data) {
			console.log('%cThe weather in %s: %s', 'color: green', data.name, data.weather[0].description);
		}],
		'error': [function (xhr) {
			console.error('An error has occurred while trying to fetch');
		}]
	});
	// Register a query which fetches weather by city name:
	ElephantJS.register('Weather', 'ByCity', {
		'endpoint': '{{inherit}}?q={{city}},{{county}}'
	});
	// Register a query which fetches weather by coordinates:
	ElephantJS.register('Weather', 'ByCoords', {
		'endpoint': '{{inherit}}?lat={{lat}}&lon={{lon}}'
	});
	// Execute the first query for London as location:
	ElephantJS.execute('Weather', 'ByCity', {}, {
		'city': 'London',
		'county': 'uk'
	});
	// Execute the first query for Tel Aviv as location:
	ElephantJS.execute('Weather', 'ByCity', {}, {
		'city': 'Tel Aviv',
		'county': 'il'
	});
	// Execute the second query:
	ElephantJS.execute('Weather', 'ByCoords', {}, {
		'lat': 41.881944,
		'lon': -87.627778
	});
	// Execute AGAIN the first query for London as location, to check the caching:
	window.setTimeout(function () {
		ElephantJS.execute('Weather', 'ByCity', {}, {
			'city': 'London',
			'county': 'uk'
		});
	}, 5000);
</script>
</body>
</html>
